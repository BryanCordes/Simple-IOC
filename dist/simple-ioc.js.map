{"version":3,"file":"simple-ioc.js","sources":["../src/includes/service.js","../src/container.js","../src/ioc.js"],"sourcesContent":["class Service {\r\n    #definition;\r\n    #type;\r\n    #dependencies;\r\n\r\n    get definition() {\r\n        return this.#definition;\r\n    }\r\n\r\n    get type() {\r\n        return this.#type;\r\n    }\r\n\r\n    get dependencies() {\r\n        return this.#dependencies;\r\n    }\r\n\r\n    constructor(definition, type, dependencies) {\r\n        this.#definition = definition;\r\n        this.#type = type;\r\n        this.#dependencies = dependencies;\r\n    }\r\n}\r\n\r\nexport default Service;","import Service from \"./includes/service.js\";\r\n\r\nclass Container {\r\n    #services;\r\n\r\n    #collection;\r\n    #singleton;\r\n\r\n    #getActions;\r\n\r\n    static get type() {\r\n        return {\r\n            singleton: 'singleton',\r\n            transient: 'transient'\r\n        };\r\n    }\r\n\r\n    get register() {\r\n        return {\r\n            asTransient: this.#asTransient,\r\n            asSingleton: this.#asSingleton,\r\n            asCollection: this.#asCollection\r\n        }\r\n    }\r\n\r\n    get(definitionOrName) {\r\n        if ( typeof definitionOrName === 'string' ) {\r\n            return this.#getCollection( definitionOrName );\r\n        }\r\n\r\n        const service = this.#services.get( definitionOrName );\r\n        if ( service ) {\r\n            const getAction = this.#getActions.get( service.type );\r\n\r\n            return getAction( definitionOrName, service );\r\n        }\r\n\r\n        throw new Error( 'Unable to find service or collection' );\r\n    }\r\n\r\n    #asTransient = (definition, dependencies) => {\r\n        this.#setService( definition, Container.type.transient, dependencies );\r\n    }\r\n\r\n    #asSingleton = (definition, dependencies) => {\r\n        this.#setService( definition, Container.type.singleton, dependencies );\r\n    }\r\n\r\n    #setService = (definition, type, dependencies) => {\r\n        const service = new Service( definition, type, dependencies );\r\n\r\n        this.#services.set( definition, service );\r\n    }\r\n\r\n    #asCollection = (name, definition, dependencies) => {\r\n        const service = new Service( definition, Container.type.transient, dependencies );\r\n\r\n        if ( this.#collection.has( name ) ) {\r\n            this.#collection.get( name ).push( service );\r\n        } else {\r\n            this.#collection.set( name, [service] );\r\n        }\r\n    }\r\n\r\n    #getCollection = (name) => {\r\n        const collection = this.#collection.get( name );\r\n        if ( !collection ) {\r\n            return undefined;\r\n        }\r\n\r\n        const instances = [];\r\n        for ( const service of collection ) {\r\n            instances.push( this.#createInstance( service ) );\r\n        }\r\n\r\n        return instances;\r\n    }\r\n\r\n    #getSingleton = (definition, service) => {\r\n        if ( this.#singleton.has( definition ) ) {\r\n            return this.#singleton.get( definition );\r\n        }\r\n\r\n        const instance = this.#createInstance( service );\r\n\r\n        this.#singleton.set( definition, instance );\r\n\r\n        return instance;\r\n    }\r\n\r\n    #getTransient = (definition, service) => {\r\n        return this.#createInstance( service );\r\n    }\r\n\r\n    #createInstance = (service) => {\r\n        return new service.definition( ...this.#getResolvedDependencies( service ) );\r\n    }\r\n\r\n    #getResolvedDependencies = (service) => {\r\n        let dependencies = [];\r\n\r\n        if ( service.dependencies ) {\r\n            dependencies = service.dependencies.map( ( deps ) => {\r\n                return this.get( deps );\r\n            });\r\n        }\r\n\r\n        return dependencies;\r\n    }\r\n\r\n    constructor() {\r\n        this.#services = new Map();\r\n        this.#collection = new Map();\r\n        this.#singleton = new Map();\r\n\r\n        this.#getActions = new Map( [\r\n            [Container.type.singleton, this.#getSingleton],\r\n            [Container.type.transient, this.#getTransient]\r\n        ] );\r\n    }\r\n}\r\n\r\nexport default Container;","import Container from \"./container.js\";\r\n\r\nclass IoC {\r\n    static #container = new Container();\r\n\r\n    static get default() {\r\n        return this.#container;\r\n    }\r\n\r\n    static getContainerInstance() {\r\n        return new Container();\r\n    }\r\n}\r\n\r\nexport default IoC;"],"names":[],"mappings":"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"}